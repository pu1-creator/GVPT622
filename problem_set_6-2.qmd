---
title: "Problem Set 6"
subtitle: "Due date: 28 October"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  echo: true
  warning: false
---

Please upload your completed assignment to the ELMs course site (under the assignments menu) and to your class Github repository. You need to upload both your Quarto document (with R code, as needed) and its rendered output (either as a PDF or HTML file).

**Total points: 35**

## Question 1

*Points: 10*

I hypothesize that the mean mathematics SAT score for University of Maryland students is different to 600. I take an SRS of 625 students and find that the mean mathematics score among those students is 610. The standard deviation of my sample is 75.

### Part A

Based on my sample, what is a point estimate for the mean mathematics SAT score for University of Maryland students?

610 is a point estimate for the mean math SAT score for UMD students.

### Part B

What is a 95% confidence interval around that estimate?

```{r}
610 + 1.96 * (75/sqrt(625))

610 - 1.96 * (75/sqrt(625))

```

The answer is between 615.88 to 604.12

### Part C

What is the null hypothesis?

The null hypothesis is that The mean mathematics SAT score for University of Maryland students is 600. H0:μ=600

### Part D

What is the two-tailed p-value and what does it mean?
```{r}

(610 - 600)/(75/sqrt(625))

```

The Z score is 3.333333, a P value of Z larger than 3.333333 is 0.00043. As a two tail, the value should be 0.00043 * 2 = 0.00086.

the p-value is the probability of observing a sample mean as extreme as or more extreme than 610, assuming the true mean SAT score is 600.

So it is hard for you to observe a value that was either 10 points higher or lower than 600.

### Part E

Do the data support my hypothesis? Why, or why not?

Since the p-value is much smaller than 0.05, we should reject the null hypothesis that mean is 600. So this result supports your hypothesis.

## Question 2

*Points: 10*

I take an SRS of 900 citizens in a public opinion survey and find that the mean feeling thermometer rating (on a 0 to 100 scale) of President Trump is 51.5 with a standard deviation of 25. Now, suppose I hypothesize that feelings toward Trump should be greater than 50.

### Part A

What is the null hypothesis?

The null hypothesis is that the mean feeling thermometer rating of President Trump in the population is 50.

### Part B

What is a 95% confidence interval around the sample statistic? Does this interval indicate support for a two-tailed test of my hypothesis (`p < 0.05` as the threshold)? Why, or why not?

```{r}


51.5 + 1.96 * (25/sqrt(900))

51.5 - 1.96 * (25/sqrt(900))

(51.5 - 50)/(25/sqrt(900))

```

The CI is between 49.87 to 53.13. The Z score is 1.8, and the P(Z>1.8)=0.0359, for a two tailed test, p = 0.0718. The p-value is larger than 0.05, so we can not reject the null hypothesis. It did not support the hypothesize that feelings toward Trump should be greater than 50.

### Part C

What is a 90% confidence interval around the sample statistic? Does this interval indicate support for a one-tailed test of my hypothesis (`p < 0.05` as the threshold)? Why, or why not?

```{r}

51.5 + 1.645 * (25/sqrt(900))

51.5 - 1.645 * (25/sqrt(900))

(51.5 - 50)/(25/sqrt(900))

```

The CI is between 50.13 to 52.87. The Z score is 1.8, and the P(Z>1.8)=0.0359, The p-value is smaller than 0.05, so we can reject the null hypothesis. It supports the hypothesize that feelings toward Trump should be greater than 50.


## Question 3

*Points: 5*

Suppose I conduct a difference of means test and obtain a t-statistic of 2.50. What does this indicate about the statistical significance of the sample mean compared to the null hypothesis?

t=2.50 means your observed difference is 2.5 standard errors away from what the null hypothesis predicts. Thus the p-value of this T score would be much lower than 0.05. We can reject the null hypothesis.

## Question 4

*Points: 5*

I hypothesize that fewer than 40% of registered voters approve of President Trump. I conduct an SRS of 720 registered voters and find that 37.9% of them approve of President Trump.

### Part A

Based on my sample, what is a point estimate for the proportion of the population that approves of President Trump?

The point estimate for the proportion is 37.9%

### Part B

What is a 90% confidence interval around that estimate?

```{r}

0.379 - 1.645 * sqrt((0.379*(1-0.379))/720)

0.379 + 1.645 * sqrt((0.379*(1-0.379))/720)
```

The CI is between 34.9% to 40.9%

### Part C

What is the null hypothesis?
The null hypothesis is the population proportion of registered voters who approve of President Trump is 40%, p = 40%

### Part D

What is the one-tailed p-value and what does it mean?

```{r}

(0.379 - 0.4) / sqrt((0.379*(1-0.379))/720)

```

The Z score is -1.162, a P value of Z smaller than -1.162 is about 0.125, larger than 0.05. 

the p-value is the probability of observing a sample proportion of 0.379 or lower if the true population proportion were actually 0.40.

So we failed to reject the null hypothesis. 

### Part E

Do the data support my hypothesis? Why, or why not?

No, the data do not provide statistically significant evidence that fewer than 40% of registered voters approve of President Trump. The p-value is much higher that 0.05, so we cannot reject the null hypothesis.

## Question 5

*Points: 5*

```{r}

library(wbstats)
library(tidyverse)

q_5_df <- wb_data(c("SP.DYN.TFRT.IN", "SE.ADT.1524.LT.FE.ZS"),
                  start_date = 2022,
                  end_date = 2022) |> 
  rename(lit_rate = `SE.ADT.1524.LT.FE.ZS`,
         fertility = `SP.DYN.TFRT.IN`) |> 
  mutate(lit_rate = cut_interval(lit_rate, 2, labels = c("Lower half", "Upper half"))) |> 
  drop_na(fertility, lit_rate)
```

I hypothesize that countries with higher rates of literacy among young women have lower birth rates, on average, compared to countries that have lower rates of young female literacy. Use data collected above from the World Bank to test my hypothesis. State the null hypothesis and interpret what the results tell us about the null and alternative hypotheses. Show all relevant work in a professional format.



1.Compute the test statistic from the sample
```{r}
fer_avg <- q_5_df %>% 
  group_by(lit_rate) %>% 
  summarise(n_countries = n(),
            avg_fer = mean(fertility)) %>% 
  mutate(diff_means = avg_fer - lead(avg_fer))

diff_means <- fer_avg %>% 
  drop_na(diff_means) %>% 
  pull(diff_means)

diff_means

```

On average, low women literacy rate countries have 2.89 higher fertility rate than high women literacy rate countries.


2. Define Hypothesis

We want to compare the mean fertility rates between two groups, so we have:

μ1 = mean fertility rate for lower-literacy countries
μ2 = mean fertility rate for higher-literacy countries

The null hypotheses is μ1 = μ2, which could be "On average, there is no difference in fertility rate between low women literacy rate countries and high women literacy rate countries.

The alternative hypothese is μ1 > μ2, which could be "countries with higher rates of literacy among young women have lower birth rates, on average, compared to countries that have lower rates of young female literacy."

3. Generate many simulated data sets from the null hypothesis model

```{r}
library(infer)
fert_null <- q_5_df %>% 
  specify(fertility ~ lit_rate) %>%  
  hypothesize(null = "independence") %>% 
  generate(reps = 5000, type = "permute")

fert_null



```

4. Compute the test statistic for each of these null worlds

```{r}
fert_diffs_null <- fert_null %>% 
  calculate("diff in means", order = c("Lower half", "Upper half"))
visualize(fert_diffs_null) + 
  labs(x = "Simulated difference in average fert ratings (Lower half literacy − Upper half literacy)", y = "Count",
       title = "Simulation-based null distribution of differences in means")


```

Step 5: Work out whether our sample could plausibly exist in this null world

```{r}

CI <- get_confidence_interval(fert_diffs_null)
CI

visualize(fert_diffs_null) + 
  shade_confidence_interval(CI, color = "#8bc5ed", fill = "#85d9d2") + geom_vline(xintercept = diff_means, size = 1, color = "#77002c") +
  labs(x = "Simulated difference in average fert ratings (Lower Half − Upper Half)", y = "Count",
       title = "Simulation-based null distribution of differences in means")

quantile(fert_diffs_null$stat, probs = c(0.025, 0.975))

```
```{r}
library(tidyverse)
library(janitor)
library(broom)
library(infer)
library(scales)


fert_diffs_null  %>%  
  get_p_value(obs_stat = diff_means, direction = "greater") %>% 
  mutate(p_value_clean = pvalue(p_value))
```

A p-value <0.001 gives strong statistical evidence to reject the null hypothesis which claim there is no difference in fertility rate between low women literacy rate countries and high women literacy rate countries. Thus we can say countries with higher rates of literacy among young women have lower birth rates, on average, compared to countries that have lower rates of young female literacy.

