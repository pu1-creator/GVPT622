---
title: "Problem Set 3"
subtitle: "Due date: 30 September"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  warning: false

---

Please upload your completed assignment to the ELMs course site (under the assignments menu) and to your class Github repository. You need to upload both your Quarto document (with R code, as needed) and its rendered output (either as a PDF or HTML file).

**Total points: 27**

```{r}
dem_wealth_df <- readr::read_csv("http://svmiller.com/extdata/democracy-income-1950.csv") |> 
  dplyr::transmute(iso3c, country, gdp_per_cap = wbgdp2011est / wbpopest, democracy_score = xm_qudsest)
```

The `dem_wealth_df` data set (taken from the wonderful Dr Steven V Miller's [blog post](https://svmiller.com/blog/2023/09/democracy-income-correlation-analysis/)) will help us explore the relationship between a country's level of democracy and its citizens' wealth in 1950. It is a replication of [Lipset (1959)](https://www.cambridge.org/core/journals/american-political-science-review/article/abs/some-social-requisites-of-democracy-economic-development-and-political-legitimacy1/26559429359F42D3E9B8BC82CA65546A). Miller uses Xavier Marquez's [measure for democracy](https://www.cambridge.org/core/journals/political-analysis/article/democratic-compromise-a-latent-variable-analysis-of-ten-measures-of-regime-type/2A6B2BBA6F80367644F2C5007E1CFC29). This is a great (if complicated) measure. For this problem set, you only need to know that a country's level of democracy increases with its "democracy score".

## Question 1

### Part A

```{r}
library(tidyverse) 
library(skimr) 
library(janitor) 
library(ggsci) 
library(RColorBrewer) 
library(paletteer) 
library(devtools)
library(polisciols)
library(modelsummary)
```

*Points: 2*

> Using the `dem_wealth_df` data frame loaded in above, produce a scatter plot of the variables `democracy_score` and `gdp_per_cap` (with `gdp_per_cap` as the dependent variable on the y-axis). Professionally format your graph.

```{r}
dem_wealth_df %>% ggplot(aes(x = democracy_score, y = gdp_per_cap, na.rm = T)) +
  geom_point()+
  theme_minimal() + labs(
    title = "Relations between Democracy Score and GDP per Capita", x = "Democracy Score", y = "GDP per Capita")

```

### Part B

*Points: 3*

> Describe the scatter plot. Note suspected outliers if any exist (a visual inspection will suffice for this question).

At lower democracy scores (around -1 to 0), GDP per capita values are clustered mostly below \$10,000, with many countries concentrated below \$5,000. They also have limited variation.

At higher democracy scores (1 to 2), GDP per capita tends to increase, with several countries above \$10,000. They are wider spread than the countried with lower democracy scores

The overall pattern suggests a positive association: countries with higher democracy scores tend to have higher GDP per capita.

One point near Democracy Score \~0 with GDP per capita around \$10,000 stands noticeably higher than its neighbors.

Two points at Democracy Score \~1 with GDP per capita exceeding \$15,000 also stand out as unusually high relative to the main cluster.

## Question 2

*Points: 2*

> Calculate the correlation coefficient between `democracy_score` and `gdp_per_cap`. What does it tell you about the relationship between a country's level of democracy and its citizens' wealth?

```{r}
cor(dem_wealth_df$democracy_score, dem_wealth_df$gdp_per_cap)
```

The relationship between a country's level of democracy and its citizens' wealth is positive and strong. The higher country's level of democracy correlated to higher citizens' wealth.

## Question 3

I would like to know whether individuals with higher levels of education tend to pay greater levels of attention to politics than those with lower levels of education.

### Part A

*Points: 5*

> Using the `nes2024` data set in the `polisciols` R package, construct a cross-tab of the relationship between `attention_to_politics` and `education`.

```{r}

datasummary_crosstab(attention_to_politics ~ education, data = nes2024)
```

### Part B

*Points: 3*

> Describe the relationship between these two variables (if one exists).

Higher education is associated with higher political attention. Those with lower education are more likely to  only "sometimes of the times". Those with higher education (especially graduate degrees) are much more likely to pay attention “Most of the time” or “Always.”

## Question 4

*Points: 5*

I hypothesize that US voters who identify as being religious are less likely to support Federal government funding of scientific research. To test this, I run a survey of a representative sample of the US voting population. I ask respondents to indicate how often they attend religious ceremonies as a proxy measure of how strongly they identify as religious. They can answer: never, only for significant events, or regularly. Next, I ask respondents whether they think the Federal government's funding of scientific research is "too little", "about right", or "too much".

> Describe how you would construct a cross-tab to evaluate my hypothesis. Which responses (religious identification or support for Federal funding) would you compare within? Relatedly, which would you vary? Finally, what statistics would you use to make your comparisons?

In this cross-tab, I will have religious identification as the independent variable, and support for Federal funding as dependent variable. Thus I will know the relationship between these two variables. The table will include the number and proportion of respondents for each level of funding according to how often they attend religious ceremonies.

## Question 5

Let's return to our original question of the relationship between democracy and individuals' wealth.

### Part A

*Points: 2*

> Create two new variables based on a country's level of democracy, and its citizens' wealth. For the democracy variable, split countries into three categories: `autocracy` if they score in the lowest third of democracy scores, `hybrid` if they score in the middle third, and `democracy` if they score in the highest third. Similarly, for the wealth variable, split countries into three categories: `low income` if they score in the lowest third of GDP per capita, `middle income` if they score in the middle third, and `high income` if they score in the highest third.

```{r}

dem_wealth_lv <- dem_wealth_df %>% mutate ( levelOfDemocracy =
  case_when(democracy_score  <= quantile(democracy_score, 1/3, na.rm = TRUE) ~ "autocracy",
            democracy_score  > quantile(democracy_score, 1/3, na.rm = TRUE) & democracy_score  <= quantile(democracy_score, 2/3, na.rm = TRUE) ~ "hybrid",
            democracy_score  > quantile(democracy_score, 2/3, na.rm = TRUE) ~ "democracy"
)) %>% 
  mutate(levelOfWealth =
    case_when(gdp_per_cap  <= quantile(gdp_per_cap, 1/3, na.rm = TRUE) ~ "low income",
            gdp_per_cap  > quantile(gdp_per_cap, 1/3, na.rm = TRUE) & gdp_per_cap  <= quantile(gdp_per_cap, 2/3, na.rm = TRUE) ~ "middle income",
            gdp_per_cap  > quantile(gdp_per_cap, 2/3, na.rm = TRUE) ~ "high income")
    
  ) %>% 
mutate(
    levelOfDemocracy = factor(levelOfDemocracy,
                              levels = c("autocracy", "hybrid", "democracy")),
    levelOfWealth = factor(levelOfWealth,
                           levels = c("low income", "middle income", "high income"))
  )

dem_wealth_lv
```

### Part B

*Points: 3*

> Create a cross-tab.

```{r}

datasummary_crosstab(levelOfDemocracy ~ levelOfWealth, data = dem_wealth_lv)

```
### Part C

*Points: 5*

> Describe the relationship between these variables.

There is a very strong relationship between a country's political regime and its level of wealth.

Autocracies are overwhelmingly low-income or middle-income.

Democracies are overwhelmingly high-income.

Hybrid regimes fall in between, but lean towards lower income levels.

The higher level of democracy is associated with higher income and lower evel of democracy is associated with lower income, while hybrid regimes are somewhat transitional across income levels. 

